<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>world/menu/Messages.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Animal.html">Animal</a><ul class='methods'><li data-type='method'><a href="Animal.html#followDirection">followDirection</a></li><li data-type='method'><a href="Animal.html#isVisible">isVisible</a></li><li data-type='method'><a href="Animal.html#listen">listen</a></li><li data-type='method'><a href="Animal.html#pathfind">pathfind</a></li><li data-type='method'><a href="Animal.html#timedMovement">timedMovement</a></li></ul></li><li><a href="ContextMenu.html">ContextMenu</a><ul class='methods'><li data-type='method'><a href="ContextMenu.html#createContextMenu">createContextMenu</a></li></ul></li><li><a href="Debug.html">Debug</a><ul class='methods'><li data-type='method'><a href="Debug.html#fps">fps</a></li><li data-type='method'><a href="Debug.html#mousePos">mousePos</a></li><li data-type='method'><a href="Debug.html#sprite">sprite</a></li><li data-type='method'><a href="Debug.html#switch">switch</a></li><li data-type='method'><a href="Debug.html#tiles">tiles</a></li></ul></li><li><a href="Guide.html">Guide</a><ul class='methods'><li data-type='method'><a href="Guide.html#button">button</a></li><li data-type='method'><a href="Guide.html#configureWindow">configureWindow</a></li></ul></li><li><a href="Inventory.html">Inventory</a><ul class='methods'><li data-type='method'><a href="Inventory.html#addItem">addItem</a></li><li data-type='method'><a href="Inventory.html#addItems">addItems</a></li><li data-type='method'><a href="Inventory.html#click">click</a></li><li data-type='method'><a href="Inventory.html#onClick">onClick</a></li><li data-type='method'><a href="Inventory.html#placeItem">placeItem</a></li><li data-type='method'><a href="Inventory.html#reset">reset</a></li></ul></li><li><a href="Item.html">Item</a><ul class='methods'><li data-type='method'><a href="Item.html#action">action</a></li><li data-type='method'><a href="Item.html#threeDInitialize">threeDInitialize</a></li></ul></li><li><a href="Map.html">Map</a><ul class='methods'><li data-type='method'><a href="Map.html#createTileMap">createTileMap</a></li></ul></li><li><a href="Message.html">Message</a><ul class='methods'><li data-type='method'><a href="Message.html#add">add</a></li><li data-type='method'><a href="Message.html#display">display</a></li><li data-type='method'><a href="Message.html#format">format</a></li></ul></li><li><a href="Mouse.html">Mouse</a><ul class='methods'><li data-type='method'><a href="Mouse.html#reset">reset</a></li><li data-type='method'><a href="Mouse.html#selected">selected</a></li><li data-type='method'><a href="Mouse.html#update">update</a></li></ul></li><li><a href="Player.html">Player</a><ul class='methods'><li data-type='method'><a href="Player.html#visionRadius">visionRadius</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#createAnimals">createAnimals</a></li><li><a href="global.html#determineBounds">determineBounds</a></li><li><a href="global.html#determineDirections">determineDirections</a></li><li><a href="global.html#determineTileRadius">determineTileRadius</a></li><li><a href="global.html#dim">dim</a></li><li><a href="global.html#direction">direction</a></li><li><a href="global.html#globals">globals</a></li><li><a href="global.html#isInBounds">isInBounds</a></li><li><a href="global.html#keymap">keymap</a></li><li><a href="global.html#keymapTrack">keymapTrack</a></li><li><a href="global.html#manipulateDirection">manipulateDirection</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">world/menu/Messages.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>(function () {"use strict";})();
/**
 * Created by apizzimenti on 7/15/16.
 */
 
/**
 * @author Anthony Pizzimenti
 *
 * @desc The Message structure handles all the popup messages in the game.
 *
 * @param game {object} Current Phaser game instance.
 * @param size {number} Font size.
 * @param [loc="bottom_left"] {string} Preferred location for messages: can be &lt;code>"bottom_left"&lt;/code>, &lt;code>"bottom_right"&lt;/code>,
 * &lt;code>"top_left"&lt;/code>, or &lt;code>"top_right"&lt;/code>.
 *
 * @property game {object} Phaser game instance.
 * @property y {number} Height of the game.
 * @property message {string | string[]} Message to be displayed.
 * @property fontSize {number} Font size.
 * @property style {object} Message styling.
 * @property style.font {string} Font style.
 * @property style.fill {string} Hexadecimal color value.
 * @property alert {Signal} Signal.
 *
 * @class {object} Message
 * @this Message
 * @constructor
 */

function Message (game, size, loc) {
    
    this.game = game;
    this.y = this.game.height;
    this.message = "";
    this.loc = loc;
    this.fontSize = size;
    this.style = {
        font: size + "px Courier",
        fill: "#FFFFFF"
    };
    
    this.alert = new Phaser.Signal();
    
    this.alert.add(() => {this.display()});
}

/**
 * @author Anthony Pizzimenti
 *
 * @desc Adds the provided message to the queue.
 *
 * @param message {string} Message to be added to the queue.
 *
 * @this Message
 */

Message.prototype.add = function (message) {
    this.message = message;
    this.alert.dispatch();
};

/**
 * @author Anthony Pizzimenti
 *
 * @desc Displays the message on the screen for five seconds, with in and out tweens.
 *
 * @this Message
 *
 * @todo get messages queue to work
 */

Message.prototype.display = function () {
    
    var str = this.format(this.message);
    
    this.text = this.game.add.text(str.x, str.y, str.msg, this.style);
    
    this.text.alpha = 0;
    this.text.fixedToCamera = true;
    
    this.game.add.tween(this.text).to({alpha: 1}, 500, Phaser.Easing.Linear.None, true, 0, 0, false);
    
    this.game.time.events.add(Phaser.Timer.SECOND * 5, () => {
        this.game.add.tween(this.text).to({alpha: 0}, 500, Phaser.Easing.Linear.None, true, 0, 0, false);
    });
};

/**
 * @author Anthony Pizzimenti
 *
 * @desc Formats messages so they are 60 characters wide.
 *
 * @param message {string} Message to be formatted.
 *
 * @returns {{x: number, y: number, msg: string}} Width and height of Phaser message area; formatted string.
 *
 * @todo Format according to where words are, not just the 60th character.
 */

Message.prototype.format = function (message) {
    
    var last = 0,
        strs = [],
        dist = message.length % 60 ? message.length - (message.length % 60) : 0,
        vals = {};
    
    for (var i = 0; i &lt; message.length; i++) {
        
        if (!(i % 60) &amp;&amp; i !== 0) {
            strs.push(message.slice(last, i) + "\n");
            last = i;
        } else if (dist === 0 &amp;&amp; i === message.length - 1) {
            strs.push(message.slice(last, message.length));
        } else if (i > dist &amp;&amp; dist !== 0) {
            strs.push(message.slice(last, message.length));
            break;
        }
    }
    
    switch (this.loc) {
        
        case "bottom_left": default:
            vals.x = 10;
            vals.y = this.y - (strs.length * this.fontSize * 1.8);
            break;
            
        case "top_left":
            vals.x = 10;
            vals.y = strs.length * (this.fontSize * 1.8);
            break;
        
        case "top_right":
            vals.x = this.game.width - 540;
            vals.y = 10;
            break;
        
        case "bottom_right":
            vals.x = this.game.width - 540;
            vals.y = this.y - (strs.length * this.fontSize * 1.8);
            break;
    }
    
    console.log(strs[0].length * this.fontSize);
    
    vals.msg = strs.join(" ");
    return vals;
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Aug 10 2016 10:53:18 GMT-0500 (CDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
